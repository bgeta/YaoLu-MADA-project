---
title: "An example exploratory analysis script"
author: "Yao Lu"
date: "03/11/2023"
output: html_document
---

  
  
This Quarto file loads the cleaned data and does some exploring.



# Setup

```{r}
#load needed packages. make sure they are installed.
library(readxl)
library(readr)
library(DataExplorer)
library(dplyr)
library(ggplot2)
library(here)
library(skimr)
```


Load the data.

```{r}
#loading the data
data_location <- here::here("data","raw_data","Georgia_DPH_PUBLIC_Vaccination_Public_Data_in_Excel.xlsx")
vacin <- readxl::read_excel(data_location,sheet=2)

data_location1 <- here::here("data","raw_data",'ga_covid_data',"county_cases.csv")

cases <- read_csv(data_location1)
```





# Data exploration through tables

Showing a bit of code to produce and save a summary table.


```{r}
summary_df = skimr::skim(mydata)
print(summary_df)
# save to file
summarytable_file = here("results", "summarytable.rds")
saveRDS(summary_df, file = summarytable_file)
```

We are saving the results to the `results` folder. Depending on how many tables/figures you have, it might make sense to have separate folders for each. And/or you could have separate folders for exploratory tables/figures and for final tables/figures. Just choose a setup that makes sense for your project and works for you, and provide enough documentation that someone can understand what you are doing.


# Data exploration through figures

Histogram plots for the continuous outcomes. 

Height first.

```{r}
p1 <- mydata %>% ggplot(aes(x=Height)) + geom_histogram() 
plot(p1)
figure_file = here("results","height_distribution.png")
ggsave(filename = figure_file, plot=p1) 
```

Now weights.

```{r}
p2 <- mydata %>% ggplot(aes(x=Weight)) + geom_histogram() 
plot(p2)
figure_file = here("results","weight_distribution.png")
ggsave(filename = figure_file, plot=p2) 
```

Now height as function of weight.

```{r}
p3 <- mydata %>% ggplot(aes(x=Height, y=Weight)) + geom_point() + geom_smooth(method='lm')
plot(p3)
figure_file = here("results","height_weight.png")
ggsave(filename = figure_file, plot=p3) 
```

Once more height as function of weight, stratified by gender. Note that there is so little data, it's a bit silly. But we'll plot it anyway.

```{r}
p4 <- mydata %>% ggplot(aes(x=Height, y=Weight, color = Gender)) + geom_point() + geom_smooth(method='lm')
plot(p4)
figure_file = here("results","height_weight_stratified.png")
ggsave(filename = figure_file, plot=p4) 
```



# Notes

For your own explorations, tables and figures can be "quick and dirty". As long as you can see what's going on, there is no need to polish them. That's in contrast to figures you'll produce for your final products (paper, report, presentation, website, etc.). Those should look as nice, polished and easy to understand as possible.


